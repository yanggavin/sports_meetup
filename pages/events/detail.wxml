<view class="page">
  <!-- Top App Bar -->
  <view class="top-bar">
    <view class="back-btn" bindtap="onBack">
      <text class="back-icon">â†</text>
    </view>
    <text class="h4 font-bold text-dark">æ´»åŠ¨è¯¦æƒ…</text>
    <view class="more-btn">
      <text class="more-icon">â‹¯</text>
    </view>
  </view>

  <!-- Header Image -->
  <view class="header-image" style="background-image: url('{{event.image}}')">
    <view class="header-gradient"></view>
    <view class="header-badge pill">
      <text class="badge-icon">ğŸ“</text>
      <text class="badge-text">{{event.location}}</text>
    </view>
  </view>

  <!-- Event Title -->
  <view class="event-title-section">
    <view class="row items-center gap-16">
      <view class="sport-icon-large">
        <text class="sport-icon-text-large">{{event.sportIcon}}</text>
      </view>
      <view class="col flex-1 gap-8">
        <text class="event-title-text">{{event.title}}</text>
        <view class="status-chip {{event.statusClass}}">{{event.statusLabel}}</view>
      </view>
    </view>
  </view>

  <!-- Organizer Card -->
  <view class="organizer-card">
    <view class="row items-center gap-16 flex-1">
      <image class="organizer-avatar" src="{{event.organizerAvatar}}" mode="aspectFill"></image>
      <view class="flex-1">
        <text class="organizer-label">ç»„ç»‡è€…</text>
        <text class="organizer-name">{{event.organizer}}</text>
      </view>
    </view>
    <button class="btn-message" bindtap="onMessageOrganizer">
      <text class="message-icon">ğŸ’¬</text>
      <text>ç§ä¿¡</text>
    </button>
  </view>

  <!-- Event Info -->
  <view class="info-section">
    <view class="info-card">
      <view class="info-icon-container">
        <text class="info-icon">ğŸ“…</text>
      </view>
      <text class="info-text">{{event.dateTime}}</text>
    </view>

    <view class="info-card">
      <view class="info-icon-container">
        <text class="info-icon">ğŸ“</text>
      </view>
      <view class="flex-1">
        <text class="info-text">{{event.location}}</text>
        <text class="info-subtext">{{event.address}}</text>
      </view>
      <text class="map-link" bindtap="onOpenMap">åœ¨åœ°å›¾ä¸­æ‰“å¼€</text>
    </view>
  </view>

  <!-- Club Block -->
  <view wx:if="{{event.clubName}}" class="club-section" bindtap="onViewClub">
    <view class="club-card">
      <view class="club-meta">
        <text class="club-label">æ‰€å±ä¿±ä¹éƒ¨</text>
        <text class="club-name">{{event.clubName}}</text>
      </view>
      <text class="club-link">æŸ¥çœ‹ä¿±ä¹éƒ¨ â€º</text>
    </view>
  </view>

  <!-- Participants -->
  <view class="participants-section">
    <view class="row items-center justify-between mb-16">
      <text class="section-title">å·²å‚åŠ  {{event.participants}}/{{event.maxParticipants}}</text>
      <text class="view-all-link" bindtap="onViewAllParticipants">æŸ¥çœ‹å…¨éƒ¨</text>
    </view>
    <view class="participants-avatars row items-center gap-16">
      <view class="avatar-stack">
        <image wx:for="{{event.participantAvatars}}" wx:key="index" class="participant-avatar" src="{{item}}" mode="aspectFill" style="margin-left: {{index > 0 ? '-24rpx' : '0'}}; z-index: {{100 - index}}"></image>
        <view wx:if="{{event.participants > event.participantAvatars.length}}" class="participant-more" style="margin-left: -24rpx">+{{event.participants - event.participantAvatars.length}}</view>
      </view>
    </view>
  </view>

  <!-- Description -->
  <view class="description-section">
    <text class="section-title mb-16">æ´»åŠ¨è¯¦æƒ…</text>
    <text class="description-text">{{event.description}}</text>
  </view>

  <!-- Organizer Tools (Only for event owner) -->
  <view wx:if="{{event.isOrganizer}}" class="organizer-tools">
    <text class="section-title mb-16">ç»„ç»‡è€…å·¥å…·</text>
    <view class="tools-grid">
      <button class="tool-btn" bindtap="onEditEvent">
        <text class="tool-icon">âœï¸</text>
        <text>ç¼–è¾‘æ´»åŠ¨</text>
      </button>
      <button class="tool-btn tool-btn-danger" bindtap="onCancelEvent">
        <text class="tool-icon">âŒ</text>
        <text>å–æ¶ˆæ´»åŠ¨</text>
      </button>
      <button class="tool-btn tool-btn-full" bindtap="onBroadcast">
        <text class="tool-icon">ğŸ“¢</text>
        <text>ç¾¤å‘é€šçŸ¥</text>
      </button>
    </view>
  </view>

  <!-- Bottom Spacer -->
  <view style="height: 200rpx"></view>

  <!-- Sticky Action Bar -->
  <view class="action-bar">
    <button class="btn-action-primary" bindtap="onJoin" disabled="{{!event.joined && event.disableJoin}}">{{event.joined ? 'é€€å‡ºæ´»åŠ¨' : 'å‚åŠ æ´»åŠ¨'}}</button>
    <button class="btn-action-share" bindtap="onShare">
      <text class="share-icon">â†—</text>
    </button>
  </view>
</view>
